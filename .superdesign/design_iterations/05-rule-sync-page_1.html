<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; font-src 'self' https://cdn.jsdelivr.net; script-src 'nonce-{{nonce}}';"
    />
    <title>è§„åˆ™åŒæ­¥é¡µ - Turbo AI Rules</title>
    <!-- Codicons å›¾æ ‡åº“ -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@vscode/codicons@0.0.35/dist/codicon.css"
    />
    <style>
      :root {
        /* VS Code ä¸»é¢˜å˜é‡ */
        --vscode-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica,
          Arial, sans-serif;
        --vscode-font-weight: 400;
        --vscode-font-size: 13px;
        --vscode-foreground: #cccccc;
        --vscode-descriptionForeground: #8c8c8c;

        /* èƒŒæ™¯è‰² */
        --vscode-editor-background: #1e1e1e;
        --vscode-editorWidget-background: #252526;
        --vscode-input-background: #3c3c3c;

        /* è¾¹æ¡† */
        --vscode-editorWidget-border: #454545;
        --vscode-focusBorder: #007fd4;

        /* æŒ‰é’® */
        --vscode-button-background: #0e639c;
        --vscode-button-foreground: #ffffff;
        --vscode-button-hoverBackground: #1177bb;
        --vscode-button-secondaryBackground: #3a3d41;
        --vscode-button-secondaryForeground: #ffffff;
        --vscode-button-secondaryHoverBackground: #45494e;

        /* åˆ—è¡¨ */
        --vscode-list-hoverBackground: #2a2d2e;

        /* æµ‹è¯•å›¾æ ‡é¢œè‰² */
        --vscode-testing-iconPassed: #73c991;
        --vscode-charts-blue: #75beff;

        /* å›¾æ ‡ */
        --vscode-icon-foreground: #c5c5c5;

        /* é—´è·ç³»ç»Ÿ */
        --spacing-xs: 4px;
        --spacing-sm: 8px;
        --spacing-md: 12px;
        --spacing-lg: 16px;
        --spacing-xl: 20px;
        --border-radius: 4px;
        --tree-node-height: 28px;
        --tree-indent: 20px;
      }

      * {
        box-sizing: border-box;
      }

      body {
        font-family: var(--vscode-font-family);
        font-weight: var(--vscode-font-weight);
        font-size: var(--vscode-font-size);
        color: var(--vscode-foreground);
        background-color: var(--vscode-editor-background);
        margin: 0;
        padding: 0;
        height: 100vh;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      /* Header */
      .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--spacing-md) var(--spacing-lg);
        border-bottom: 1px solid var(--vscode-editorWidget-border);
        background: var(--vscode-editorWidget-background);
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .header-title {
        font-size: 16px;
        font-weight: 600;
        margin: 0;
      }

      /* Statistics */
      .statistics {
        display: flex;
        align-items: center;
        gap: var(--spacing-lg);
        padding: var(--spacing-sm) var(--spacing-lg);
        background: var(--vscode-editorWidget-background);
        border-bottom: 1px solid var(--vscode-editorWidget-border);
        font-size: 12px;
        color: var(--vscode-descriptionForeground);
      }

      .statistics span {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
      }

      .statistics strong {
        color: var(--vscode-foreground);
      }

      /* Main Content - åŒé¢æ¿å¸ƒå±€ */
      .main-content {
        flex: 1;
        display: flex;
        overflow: hidden;
      }

      /* å·¦ä¾§é¢æ¿ - è§„åˆ™æ ‘ */
      .left-panel {
        flex: 1;
        display: flex;
        flex-direction: column;
        border-right: 1px solid var(--vscode-editorWidget-border);
        min-width: 300px;
      }

      .left-panel-header {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        padding: var(--spacing-sm) var(--spacing-md);
        border-bottom: 1px solid var(--vscode-editorWidget-border);
      }

      .search-input {
        flex: 1;
        background-color: var(--vscode-input-background);
        color: var(--vscode-foreground);
        border: 1px solid var(--vscode-editorWidget-border);
        border-radius: var(--border-radius);
        padding: var(--spacing-xs) var(--spacing-sm);
        font-size: 13px;
        font-family: inherit;
      }

      .search-input:focus {
        outline: none;
        border-color: var(--vscode-focusBorder);
      }

      .left-panel-actions {
        display: flex;
        gap: var(--spacing-xs);
      }

      /* è§„åˆ™æ ‘å®¹å™¨ */
      .rules-tree-container {
        flex: 1;
        overflow-y: auto;
        padding: var(--spacing-sm);
      }

      /* æ ‘èŠ‚ç‚¹ */
      .tree-node {
        user-select: none;
      }

      .tree-node-item {
        display: flex;
        align-items: center;
        height: var(--tree-node-height);
        padding-right: var(--spacing-sm);
        cursor: pointer;
        transition: background-color 0.1s;
      }

      .tree-node-item:hover {
        background-color: var(--vscode-list-hoverBackground);
      }

      .tree-node-indent {
        width: var(--tree-indent);
        flex-shrink: 0;
      }

      .tree-node-chevron {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 16px;
        height: 16px;
        cursor: pointer;
        color: var(--vscode-icon-foreground);
        flex-shrink: 0;
      }

      .tree-node-chevron:hover {
        color: var(--vscode-foreground);
      }

      .tree-node-chevron.empty {
        visibility: hidden;
      }

      .tree-node-chevron .codicon {
        font-size: 12px;
        transition: transform 0.2s;
      }

      .tree-node-chevron.expanded .codicon {
        transform: rotate(90deg);
      }

      .tree-node-checkbox {
        margin: 0 var(--spacing-xs);
        cursor: pointer;
        flex-shrink: 0;
      }

      .tree-node-icon {
        margin-right: var(--spacing-xs);
        color: var(--vscode-icon-foreground);
        flex-shrink: 0;
      }

      .tree-node-icon .codicon {
        font-size: 14px;
      }

      .tree-node-label {
        flex: 1;
        font-size: 13px;
      }

      .tree-node-badge {
        background-color: var(--vscode-badge-background, #4d4d4d);
        color: var(--vscode-badge-foreground, #ffffff);
        padding: 2px 6px;
        border-radius: 10px;
        font-size: 11px;
        margin-left: var(--spacing-xs);
      }

      .tree-node.hidden {
        display: none;
      }

      /* æºèŠ‚ç‚¹ç‰¹æ®Šæ ·å¼ */
      .tree-node.source {
        font-weight: 600;
        margin-bottom: var(--spacing-xs);
      }

      /* å³ä¾§é¢æ¿ - é€‚é…å™¨åˆ—è¡¨ */
      .right-panel {
        flex: 1;
        display: flex;
        flex-direction: column;
        min-width: 300px;
      }

      .right-panel-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--spacing-sm) var(--spacing-md);
        border-bottom: 1px solid var(--vscode-editorWidget-border);
        font-weight: 600;
      }

      .right-panel-actions {
        display: flex;
        gap: var(--spacing-xs);
      }

      /* é€‚é…å™¨å®¹å™¨ */
      .adapters-container {
        flex: 1;
        overflow-y: auto;
        padding: var(--spacing-md);
      }

      /* é€‚é…å™¨å¡ç‰‡ */
      .adapter-card {
        background-color: var(--vscode-editorWidget-background);
        border: 1px solid var(--vscode-editorWidget-border);
        border-radius: var(--border-radius);
        padding: var(--spacing-md);
        margin-bottom: var(--spacing-sm);
        cursor: pointer;
        transition: all 0.1s;
      }

      .adapter-card:hover {
        border-color: var(--vscode-focusBorder);
      }

      .adapter-card.checked {
        border-left: 3px solid var(--vscode-testing-iconPassed);
      }

      .adapter-card-header {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-xs);
      }

      .adapter-card-checkbox {
        cursor: pointer;
        flex-shrink: 0;
      }

      .adapter-card-icon {
        color: var(--vscode-icon-foreground);
        flex-shrink: 0;
      }

      .adapter-card-icon .codicon {
        font-size: 16px;
      }

      .adapter-card-name {
        flex: 1;
        font-weight: 600;
        font-size: 14px;
      }

      .adapter-card-details {
        margin-left: 40px;
        color: var(--vscode-descriptionForeground);
        font-size: 12px;
      }

      .adapter-card-detail-item {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        margin-bottom: 2px;
      }

      .adapter-card-detail-item .codicon {
        font-size: 12px;
      }

      /* Footer */
      .footer {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--spacing-md) var(--spacing-lg);
        border-top: 1px solid var(--vscode-editorWidget-border);
        background: var(--vscode-editorWidget-background);
      }

      .footer-info {
        color: var(--vscode-descriptionForeground);
        font-size: 13px;
      }

      .footer-info strong {
        color: var(--vscode-foreground);
      }

      .footer-actions {
        display: flex;
        gap: var(--spacing-sm);
      }

      /* æŒ‰é’® */
      .btn {
        border: none;
        padding: var(--spacing-sm) var(--spacing-md);
        border-radius: var(--border-radius);
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: var(--spacing-xs);
        font-size: 13px;
        font-family: inherit;
        transition: background-color 0.1s;
      }

      .btn .codicon {
        font-size: 14px;
      }

      .btn-primary {
        background-color: var(--vscode-button-background);
        color: var(--vscode-button-foreground);
      }

      .btn-primary:hover:not(:disabled) {
        background-color: var(--vscode-button-hoverBackground);
      }

      .btn-secondary {
        background-color: var(--vscode-button-secondaryBackground);
        color: var(--vscode-button-secondaryForeground);
      }

      .btn-secondary:hover {
        background-color: var(--vscode-button-secondaryHoverBackground);
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .btn-small {
        padding: 4px 8px;
        font-size: 12px;
      }

      /* å“åº”å¼ */
      @media (max-width: 768px) {
        .main-content {
          flex-direction: column;
        }

        .left-panel,
        .right-panel {
          min-width: unset;
        }

        .right-panel {
          border-top: 1px solid var(--vscode-editorWidget-border);
        }
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <div class="header">
      <div class="header-left">
        <i class="codicon codicon-symbol-namespace"></i>
        <h1 class="header-title">è§„åˆ™åŒæ­¥é¡µ</h1>
      </div>
    </div>

    <!-- Statistics -->
    <div class="statistics">
      <span>
        <i class="codicon codicon-file"></i>
        æ€»è§„åˆ™: <strong id="totalRules">45</strong>
      </span>
      <span>
        <i class="codicon codicon-check"></i>
        å·²é€‰è§„åˆ™: <strong id="selectedRules">0</strong>
      </span>
      <span>
        <i class="codicon codicon-extensions"></i>
        ç›®æ ‡é€‚é…å™¨: <strong id="targetAdapters">0</strong>
      </span>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- å·¦ä¾§é¢æ¿ - è§„åˆ™æ ‘ -->
      <div class="left-panel">
        <div class="left-panel-header">
          <input type="text" class="search-input" placeholder="æœç´¢è§„åˆ™..." id="searchInput" />
          <div class="left-panel-actions">
            <button class="btn btn-secondary btn-small" id="selectAllRules">å…¨é€‰</button>
            <button class="btn btn-secondary btn-small" id="clearAllRules">æ¸…é™¤</button>
          </div>
        </div>

        <div class="rules-tree-container" id="rulesTree">
          <!-- è§„åˆ™æº A -->
          <div class="tree-node source">
            <div class="tree-node-item">
              <div class="tree-node-chevron expanded">
                <i class="codicon codicon-chevron-right"></i>
              </div>
              <div class="tree-node-icon">
                <i class="codicon codicon-archive"></i>
              </div>
              <div class="tree-node-label">my-team-rules</div>
              <div class="tree-node-badge">0/20</div>
            </div>
          </div>

          <!-- å­ç›®å½• -->
          <div class="tree-node">
            <div class="tree-node-item">
              <div class="tree-node-indent"></div>
              <div class="tree-node-chevron">
                <i class="codicon codicon-chevron-right"></i>
              </div>
              <div class="tree-node-icon">
                <i class="codicon codicon-folder"></i>
              </div>
              <div class="tree-node-label">001-general-standards</div>
              <div class="tree-node-badge">0/2</div>
            </div>
          </div>

          <!-- æ–‡ä»¶ -->
          <div class="tree-node hidden">
            <div class="tree-node-item">
              <div class="tree-node-indent"></div>
              <div class="tree-node-indent"></div>
              <div class="tree-node-chevron empty"></div>
              <input
                type="checkbox"
                class="tree-node-checkbox"
                data-path="my-team-rules/001-general-standards/coding-standards.md"
              />
              <div class="tree-node-icon">
                <i class="codicon codicon-file"></i>
              </div>
              <div class="tree-node-label">coding-standards.md</div>
            </div>
          </div>

          <div class="tree-node hidden">
            <div class="tree-node-item">
              <div class="tree-node-indent"></div>
              <div class="tree-node-indent"></div>
              <div class="tree-node-chevron empty"></div>
              <input
                type="checkbox"
                class="tree-node-checkbox"
                data-path="my-team-rules/001-general-standards/naming-conventions.md"
              />
              <div class="tree-node-icon">
                <i class="codicon codicon-file"></i>
              </div>
              <div class="tree-node-label">naming-conventions.md</div>
            </div>
          </div>

          <!-- è§„åˆ™æº B -->
          <div class="tree-node source">
            <div class="tree-node-item">
              <div class="tree-node-chevron expanded">
                <i class="codicon codicon-chevron-right"></i>
              </div>
              <div class="tree-node-icon">
                <i class="codicon codicon-archive"></i>
              </div>
              <div class="tree-node-label">public-rules</div>
              <div class="tree-node-badge">0/25</div>
            </div>
          </div>

          <!-- æ›´å¤šç¤ºä¾‹... -->
        </div>
      </div>

      <!-- å³ä¾§é¢æ¿ - é€‚é…å™¨åˆ—è¡¨ -->
      <div class="right-panel">
        <div class="right-panel-header">
          <span>
            <i class="codicon codicon-extensions"></i>
            é€‰æ‹©ç›®æ ‡é€‚é…å™¨
          </span>
          <div class="right-panel-actions">
            <button class="btn btn-secondary btn-small" id="selectAllAdapters">å…¨é€‰</button>
            <button class="btn btn-secondary btn-small" id="clearAllAdapters">æ¸…é™¤</button>
          </div>
        </div>

        <div class="adapters-container" id="adaptersContainer">
          <!-- GitHub Copilot -->
          <div class="adapter-card">
            <div class="adapter-card-header">
              <input type="checkbox" class="adapter-card-checkbox" data-adapter="copilot" />
              <div class="adapter-card-icon">
                <i class="codicon codicon-hubot"></i>
              </div>
              <div class="adapter-card-name">GitHub Copilot</div>
            </div>
            <div class="adapter-card-details">
              <div class="adapter-card-detail-item">
                <i class="codicon codicon-file"></i>
                <span>è¾“å‡º: .github/copilot-instructions.md</span>
              </div>
              <div class="adapter-card-detail-item">
                <i class="codicon codicon-check"></i>
                <span>å°†åŒæ­¥ <strong>0</strong> æ¡è§„åˆ™</span>
              </div>
            </div>
          </div>

          <!-- Cursor -->
          <div class="adapter-card">
            <div class="adapter-card-header">
              <input type="checkbox" class="adapter-card-checkbox" data-adapter="cursor" />
              <div class="adapter-card-icon">
                <i class="codicon codicon-symbol-class"></i>
              </div>
              <div class="adapter-card-name">Cursor</div>
            </div>
            <div class="adapter-card-details">
              <div class="adapter-card-detail-item">
                <i class="codicon codicon-file"></i>
                <span>è¾“å‡º: .cursorrules</span>
              </div>
              <div class="adapter-card-detail-item">
                <i class="codicon codicon-check"></i>
                <span>å°†åŒæ­¥ <strong>0</strong> æ¡è§„åˆ™</span>
              </div>
            </div>
          </div>

          <!-- Continue -->
          <div class="adapter-card">
            <div class="adapter-card-header">
              <input type="checkbox" class="adapter-card-checkbox" data-adapter="continue" />
              <div class="adapter-card-icon">
                <i class="codicon codicon-debug-continue"></i>
              </div>
              <div class="adapter-card-name">Continue</div>
            </div>
            <div class="adapter-card-details">
              <div class="adapter-card-detail-item">
                <i class="codicon codicon-file"></i>
                <span>è¾“å‡º: .continuerules</span>
              </div>
              <div class="adapter-card-detail-item">
                <i class="codicon codicon-check"></i>
                <span>å°†åŒæ­¥ <strong>0</strong> æ¡è§„åˆ™</span>
              </div>
            </div>
          </div>

          <!-- Default Rules -->
          <div class="adapter-card">
            <div class="adapter-card-header">
              <input type="checkbox" class="adapter-card-checkbox" data-adapter="default" />
              <div class="adapter-card-icon">
                <i class="codicon codicon-folder"></i>
              </div>
              <div class="adapter-card-name">Default Rules</div>
            </div>
            <div class="adapter-card-details">
              <div class="adapter-card-detail-item">
                <i class="codicon codicon-folder"></i>
                <span>è¾“å‡º: rules/</span>
              </div>
              <div class="adapter-card-detail-item">
                <i class="codicon codicon-check"></i>
                <span>å°†åŒæ­¥ <strong>0</strong> æ¡è§„åˆ™</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      <div class="footer-info">
        ğŸ’¡ å·²é€‰æ‹© <strong id="footerSelectedRules">0</strong> æ¡è§„åˆ™ï¼Œå°†åŒæ­¥åˆ°
        <strong id="footerTargetAdapters">0</strong> ä¸ªé€‚é…å™¨
      </div>
      <div class="footer-actions">
        <button class="btn btn-secondary" id="cancelBtn">å–æ¶ˆ</button>
        <button class="btn btn-primary" id="syncBtn" disabled>
          <i class="codicon codicon-sync"></i>
          åŒæ­¥
        </button>
      </div>
    </div>

    <script nonce="{{nonce}}">
      const vscode = acquireVsCodeApi();

      // çŠ¶æ€ç®¡ç†
      const state = {
        selectedRules: new Set(),
        selectedAdapters: new Set(),
      };

      // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
      function updateStats() {
        const selectedRulesCount = state.selectedRules.size;
        const selectedAdaptersCount = state.selectedAdapters.size;

        // æ›´æ–°å¤´éƒ¨ç»Ÿè®¡
        document.getElementById('selectedRules').textContent = selectedRulesCount;
        document.getElementById('targetAdapters').textContent = selectedAdaptersCount;

        // æ›´æ–°åº•éƒ¨ç»Ÿè®¡
        document.getElementById('footerSelectedRules').textContent = selectedRulesCount;
        document.getElementById('footerTargetAdapters').textContent = selectedAdaptersCount;

        // æ›´æ–°åŒæ­¥æŒ‰é’®çŠ¶æ€
        const syncBtn = document.getElementById('syncBtn');
        syncBtn.disabled = selectedRulesCount === 0 || selectedAdaptersCount === 0;

        // æ›´æ–°é€‚é…å™¨å¡ç‰‡çš„è§„åˆ™æ•°é‡
        document.querySelectorAll('.adapter-card').forEach((card) => {
          const ruleCount = card.querySelector('.adapter-card-detail-item:last-child strong');
          if (ruleCount) {
            const checkbox = card.querySelector('.adapter-card-checkbox');
            ruleCount.textContent = checkbox.checked ? selectedRulesCount : 0;
          }
        });
      }

      // æ ‘èŠ‚ç‚¹å±•å¼€/æ”¶èµ·
      document.querySelectorAll('.tree-node-chevron:not(.empty)').forEach((chevron) => {
        chevron.addEventListener('click', (e) => {
          e.stopPropagation();
          chevron.classList.toggle('expanded');

          // åˆ‡æ¢å­èŠ‚ç‚¹æ˜¾ç¤º/éšè—
          let nextNode = chevron.closest('.tree-node').nextElementSibling;
          const level = chevron
            .closest('.tree-node-item')
            .querySelectorAll('.tree-node-indent').length;

          while (nextNode && nextNode.classList.contains('tree-node')) {
            const nextLevel = nextNode
              .querySelector('.tree-node-item')
              .querySelectorAll('.tree-node-indent').length;
            if (nextLevel <= level) break;

            if (nextLevel === level + 1) {
              nextNode.classList.toggle('hidden');
            }
            nextNode = nextNode.nextElementSibling;
          }
        });
      });

      // è§„åˆ™å¤é€‰æ¡†
      document.querySelectorAll('.tree-node-checkbox').forEach((checkbox) => {
        checkbox.addEventListener('change', (e) => {
          const path = checkbox.getAttribute('data-path');
          if (checkbox.checked) {
            state.selectedRules.add(path);
          } else {
            state.selectedRules.delete(path);
          }
          updateStats();
        });
      });

      // é€‚é…å™¨å¤é€‰æ¡†
      document.querySelectorAll('.adapter-card-checkbox').forEach((checkbox) => {
        checkbox.addEventListener('change', (e) => {
          const adapter = checkbox.getAttribute('data-adapter');
          const card = checkbox.closest('.adapter-card');

          if (checkbox.checked) {
            state.selectedAdapters.add(adapter);
            card.classList.add('checked');
          } else {
            state.selectedAdapters.delete(adapter);
            card.classList.remove('checked');
          }
          updateStats();
        });
      });

      // é€‚é…å™¨å¡ç‰‡ç‚¹å‡»
      document.querySelectorAll('.adapter-card').forEach((card) => {
        card.addEventListener('click', (e) => {
          if (e.target.classList.contains('adapter-card-checkbox')) return;
          const checkbox = card.querySelector('.adapter-card-checkbox');
          checkbox.checked = !checkbox.checked;
          checkbox.dispatchEvent(new Event('change'));
        });
      });

      // å…¨é€‰/æ¸…é™¤è§„åˆ™
      document.getElementById('selectAllRules').addEventListener('click', () => {
        document.querySelectorAll('.tree-node-checkbox').forEach((cb) => {
          cb.checked = true;
          state.selectedRules.add(cb.getAttribute('data-path'));
        });
        updateStats();
      });

      document.getElementById('clearAllRules').addEventListener('click', () => {
        document.querySelectorAll('.tree-node-checkbox').forEach((cb) => {
          cb.checked = false;
        });
        state.selectedRules.clear();
        updateStats();
      });

      // å…¨é€‰/æ¸…é™¤é€‚é…å™¨
      document.getElementById('selectAllAdapters').addEventListener('click', () => {
        document.querySelectorAll('.adapter-card-checkbox').forEach((cb) => {
          cb.checked = true;
          state.selectedAdapters.add(cb.getAttribute('data-adapter'));
          cb.closest('.adapter-card').classList.add('checked');
        });
        updateStats();
      });

      document.getElementById('clearAllAdapters').addEventListener('click', () => {
        document.querySelectorAll('.adapter-card-checkbox').forEach((cb) => {
          cb.checked = false;
          cb.closest('.adapter-card').classList.remove('checked');
        });
        state.selectedAdapters.clear();
        updateStats();
      });

      // åŒæ­¥æŒ‰é’®
      document.getElementById('syncBtn').addEventListener('click', () => {
        vscode.postMessage({
          command: 'sync',
          data: {
            rules: Array.from(state.selectedRules),
            adapters: Array.from(state.selectedAdapters),
          },
        });
      });

      // å–æ¶ˆæŒ‰é’®
      document.getElementById('cancelBtn').addEventListener('click', () => {
        vscode.postMessage({ command: 'cancel' });
      });

      // æœç´¢åŠŸèƒ½
      document.getElementById('searchInput').addEventListener('input', (e) => {
        const searchText = e.target.value.toLowerCase();
        document.querySelectorAll('.tree-node').forEach((node) => {
          const label = node.querySelector('.tree-node-label');
          if (label) {
            const text = label.textContent.toLowerCase();
            if (searchText === '' || text.includes(searchText)) {
              node.style.display = '';
            } else {
              node.style.display = 'none';
            }
          }
        });
      });

      // åˆå§‹åŒ–
      updateStats();
    </script>
  </body>
</html>
