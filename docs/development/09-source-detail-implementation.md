# è§„åˆ™æºè¯¦æƒ…é¡µé¢å®æ–½æ–‡æ¡£

> **å®æ–½æ—¥æœŸ**: 2025-10-29  
> **åŠŸèƒ½**: è§„åˆ™æºè¯¦ç»†ä¿¡æ¯æŸ¥çœ‹é¡µé¢  
> **çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

å®ç°äº†è§„åˆ™æºè¯¦æƒ…é¡µé¢ï¼Œç”¨äºæ˜¾ç¤ºå•ä¸ªè§„åˆ™æºçš„å®Œæ•´ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š

- **è§„åˆ™æºçš„é…ç½®è¯¦æƒ…**ï¼šGit ä»“åº“ã€åˆ†æ”¯ã€è·¯å¾„ã€è®¤è¯æ–¹å¼ç­‰
- **ç»Ÿè®¡æ•°æ®**ï¼šè§„åˆ™æ•°é‡ã€ä¼˜å…ˆçº§åˆ†å¸ƒã€æ ‡ç­¾åˆ†å¸ƒ
- **è§„åˆ™åˆ—è¡¨**ï¼šè¯¥æºåŒ…å«çš„æ‰€æœ‰è§„åˆ™ï¼Œæ”¯æŒæœç´¢å’Œç­›é€‰
- **å¿«æ·æ“ä½œ**ï¼šåŒæ­¥ã€ç¼–è¾‘ã€å¯ç”¨/ç¦ç”¨ã€åˆ é™¤è§„åˆ™æº

---

## ğŸ¯ å®æ–½å†…å®¹

### 1. åç«¯ Provider

**æ–‡ä»¶**: `src/providers/SourceDetailWebviewProvider.ts`

**æ ¸å¿ƒåŠŸèƒ½**:

- ç»§æ‰¿è‡ª `BaseWebviewProvider`
- ç®¡ç†è§„åˆ™æºè¯¦æƒ… Webview çš„ç”Ÿå‘½å‘¨æœŸ
- åŠ è½½å¹¶è®¡ç®—è§„åˆ™æºçš„ç»Ÿè®¡æ•°æ®
- å¤„ç†å‰ç«¯å‘é€çš„å„ç§æ“ä½œæ¶ˆæ¯ï¼ˆåŒæ­¥ã€ç¼–è¾‘ã€åˆ é™¤ç­‰ï¼‰
- è®¡ç®—ç¼“å­˜å¤§å°å’Œä¸‹æ¬¡åŒæ­¥æ—¶é—´

**å…³é”®æ–¹æ³•**:

```typescript
- showSourceDetail(sourceId: string): æ˜¾ç¤ºè§„åˆ™æºè¯¦æƒ…é¡µé¢
- loadAndSendData(): åŠ è½½æ•°æ®å¹¶å‘é€åˆ°å‰ç«¯
- calculateStatistics(rules): è®¡ç®—ç»Ÿè®¡æ•°æ®
- getSyncInfo(source): è·å–åŒæ­¥ä¿¡æ¯
- handleMessage(message): å¤„ç†æ¥è‡ªå‰ç«¯çš„æ¶ˆæ¯
```

### 2. å‰ç«¯é¡µé¢

**æ–‡ä»¶ç»“æ„**:

```
src/webview/source-detail/
â”œâ”€â”€ index.html           # HTML å…¥å£
â”œâ”€â”€ index.tsx            # React æ¸²æŸ“å…¥å£
â”œâ”€â”€ App.tsx              # ä¸»åº”ç”¨ç»„ä»¶
â”œâ”€â”€ source-detail.css    # æ ·å¼æ–‡ä»¶
â””â”€â”€ source-detail.ts     # Vite æ„å»ºå…¥å£
```

**ç»„ä»¶è®¾è®¡**:

- **App ç»„ä»¶**: ä¸»åº”ç”¨é€»è¾‘
- **PriorityIcon ç»„ä»¶**: ä¼˜å…ˆçº§å›¾æ ‡
- **StatusDot ç»„ä»¶**: çŠ¶æ€æŒ‡ç¤ºå™¨

**åŠŸèƒ½ç‰¹æ€§**:

1. **å“åº”å¼å¸ƒå±€**: æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨ç«¯
2. **å®æ—¶æœç´¢**: è§„åˆ™åˆ—è¡¨æ”¯æŒå®æ—¶æœç´¢
3. **å¤šç»´åº¦ç­›é€‰**: æŒ‰ä¼˜å…ˆçº§ã€æ ‡ç­¾ç­›é€‰è§„åˆ™
4. **æ‡’åŠ è½½**: åˆå§‹æ˜¾ç¤º 20 æ¡ï¼Œæ”¯æŒåŠ è½½æ›´å¤š
5. **çŠ¶æ€ç®¡ç†**: åŒæ­¥çŠ¶æ€ã€åŠ è½½çŠ¶æ€ã€é”™è¯¯å¤„ç†

### 3. å‘½ä»¤æ³¨å†Œ

**æ–‡ä»¶**: `src/commands/viewSourceDetail.ts`

**å‘½ä»¤**: `turbo-ai-rules.viewSourceDetail`

**åŠŸèƒ½**:

- å¦‚æœæä¾› sourceIdï¼Œç›´æ¥æ˜¾ç¤ºè¯¥æºçš„è¯¦æƒ…
- å¦‚æœæœªæä¾›ï¼Œæ˜¾ç¤ºå¿«é€Ÿé€‰æ‹©é¢æ¿è®©ç”¨æˆ·é€‰æ‹©

**è°ƒç”¨æ–¹å¼**:

```typescript
// ä»ä»£ç è°ƒç”¨
vscode.commands.executeCommand('turbo-ai-rules.viewSourceDetail', sourceId);

// ä»æ ‘è§†å›¾å³é”®èœå•è°ƒç”¨
// ä»å‘½ä»¤é¢æ¿è°ƒç”¨
```

### 4. é…ç½®æ›´æ–°

#### package.json

æ·»åŠ äº†å‘½ä»¤å®šä¹‰ï¼š

```json
{
  "command": "turbo-ai-rules.viewSourceDetail",
  "title": "View Source Details",
  "category": "Turbo AI Rules",
  "icon": "$(info)"
}
```

æ·»åŠ åˆ°è§„åˆ™æºçš„ä¸Šä¸‹æ–‡èœå•ï¼š

```json
{
  "command": "turbo-ai-rules.viewSourceDetail",
  "when": "view == turboAiRulesExplorer && viewItem == source",
  "group": "1_actions@4"
}
```

#### æœ¬åœ°åŒ–æ–‡ä»¶

- `package.nls.json`: è‹±æ–‡
- `package.nls.zh-cn.json`: ä¸­æ–‡

#### Vite é…ç½®

æ·»åŠ  source-detail åˆ°æ„å»ºå…¥å£ï¼š

```typescript
input: {
  'source-detail': path.resolve(__dirname, 'src/webview/source-detail/index.html'),
}
```

### 5. å¯¼å‡ºæ›´æ–°

**src/providers/index.ts**: å¯¼å‡º `SourceDetailWebviewProvider`  
**src/commands/index.ts**: å¯¼å‡º `viewSourceDetailCommand`  
**src/extension.ts**: æ³¨å†Œå‘½ä»¤å’Œ Provider

---

## ğŸ¨ ç•Œé¢è®¾è®¡

### é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Header (æºåç§°ã€çŠ¶æ€ã€æ“ä½œæŒ‰é’®)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Configurationâ”‚  â”‚  Statistics  â”‚       â”‚
â”‚  â”‚   Details    â”‚  â”‚   Overview   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Rules List (æœç´¢ã€ç­›é€‰ã€è§„åˆ™å¡ç‰‡)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒ UI å…ƒç´ 

1. **Header åŒºåŸŸ**

   - æºåç§° + çŠ¶æ€æŒ‡ç¤ºå™¨
   - Git URLï¼ˆå¯ç‚¹å‡»å¤åˆ¶ï¼‰
   - 4 ä¸ªæ“ä½œæŒ‰é’®ï¼šSyncã€Editã€Toggleã€Delete

2. **Configuration Section**

   - æºé…ç½®ä¿¡æ¯ï¼ˆIDã€åˆ†æ”¯ã€è·¯å¾„ã€è®¤è¯ï¼‰
   - åŒæ­¥çŠ¶æ€ä¿¡æ¯ï¼ˆæœ€ååŒæ­¥æ—¶é—´ã€ç¼“å­˜å¤§å°ç­‰ï¼‰

3. **Statistics Section**

   - æ€»è§„åˆ™æ•°
   - ä¼˜å…ˆçº§åˆ†å¸ƒï¼ˆå¸¦è¿›åº¦æ¡ï¼‰
   - çƒ­é—¨æ ‡ç­¾äº‘ï¼ˆå¯ç‚¹å‡»ç­›é€‰ï¼‰

4. **Rules List Section**
   - æœç´¢æ¡†ï¼ˆå®æ—¶æœç´¢ï¼‰
   - ç­›é€‰å™¨ï¼ˆæŒ‰ä¼˜å…ˆçº§ã€æ ‡ç­¾ï¼‰
   - è§„åˆ™å¡ç‰‡ï¼ˆæ˜¾ç¤ºæ ‡é¢˜ã€è·¯å¾„ã€æ ‡ç­¾ï¼‰
   - æ‡’åŠ è½½ï¼ˆåˆå§‹ 20 æ¡ï¼Œå¯åŠ è½½æ›´å¤šï¼‰

---

## ğŸ”Œ æ¶ˆæ¯åè®®

### Webview â†’ Extension

```typescript
type Message =
  | { type: 'refresh' }
  | { type: 'syncSource'; payload: { sourceId: string } }
  | { type: 'editSource'; payload: { sourceId: string } }
  | { type: 'toggleSource'; payload: { sourceId: string } }
  | { type: 'deleteSource'; payload: { sourceId: string } }
  | { type: 'viewRule'; payload: { rulePath: string } }
  | { type: 'filterByTag'; payload: { tag: string } }
  | { type: 'searchRules'; payload: { query: string } };
```

### Extension â†’ Webview

```typescript
type Message =
  | {
      type: 'sourceData';
      payload: {
        source: RuleSource;
        rules: ParsedRule[];
        statistics: SourceStatistics;
        syncInfo: SyncInfo;
      };
    }
  | { type: 'syncStatus'; payload: { status: 'syncing' | 'success' | 'error'; message?: string } }
  | { type: 'error'; payload: { message: string } };
```

---

## ğŸ“Š æ•°æ®æµ

```
ç”¨æˆ·æ“ä½œ â†’ å‘½ä»¤ â†’ Provider â†’ Webview
              â†“
          åŠ è½½æ•°æ®
              â†“
      è®¡ç®—ç»Ÿè®¡ä¿¡æ¯
              â†“
         å‘é€åˆ°å‰ç«¯
              â†“
        å‰ç«¯æ¸²æŸ“æ˜¾ç¤º
```

---

## âœ… æµ‹è¯•è¦ç‚¹

### åŠŸèƒ½æµ‹è¯•

- [ ] æ­£ç¡®æ˜¾ç¤ºè§„åˆ™æºçš„æ‰€æœ‰é…ç½®ä¿¡æ¯
- [ ] ç»Ÿè®¡æ•°æ®è®¡ç®—å‡†ç¡®ï¼ˆè§„åˆ™æ•°ã€ä¼˜å…ˆçº§åˆ†å¸ƒã€æ ‡ç­¾åˆ†å¸ƒï¼‰
- [ ] æœç´¢åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] æŒ‰ä¼˜å…ˆçº§ç­›é€‰æ­£å¸¸
- [ ] æŒ‰æ ‡ç­¾ç­›é€‰æ­£å¸¸
- [ ] åŒæ­¥åŠŸèƒ½æ­£å¸¸
- [ ] ç¼–è¾‘ã€å¯ç”¨/ç¦ç”¨ã€åˆ é™¤åŠŸèƒ½æ­£å¸¸
- [ ] æŸ¥çœ‹è§„åˆ™è¯¦æƒ…åŠŸèƒ½æ­£å¸¸

### æ€§èƒ½æµ‹è¯•

- [ ] å¤§é‡è§„åˆ™ï¼ˆ>1000ï¼‰æ—¶çš„æ¸²æŸ“æ€§èƒ½
- [ ] æœç´¢å“åº”é€Ÿåº¦
- [ ] æ‡’åŠ è½½åŠŸèƒ½æ­£å¸¸
- [ ] å†…å­˜å ç”¨åˆç†

### UI/UX æµ‹è¯•

- [ ] å“åº”å¼å¸ƒå±€åœ¨ä¸åŒçª—å£å¤§å°ä¸‹æ­£å¸¸
- [ ] ä¸»é¢˜åˆ‡æ¢æ— è§†è§‰é”™è¯¯
- [ ] æŒ‰é’®ç‚¹å‡»æœ‰è§†è§‰åé¦ˆ
- [ ] åŠ è½½çŠ¶æ€æ˜¾ç¤ºæ­£ç¡®
- [ ] é”™è¯¯æç¤ºå‹å¥½

---

## ğŸš€ ä½¿ç”¨æ–¹å¼

### 1. ä»æ ‘è§†å›¾æ‰“å¼€

å³é”®ç‚¹å‡»è§„åˆ™æº â†’ é€‰æ‹© "View Source Details"

### 2. ä»å‘½ä»¤é¢æ¿æ‰“å¼€

1. æŒ‰ `Ctrl+Shift+P` (Mac: `Cmd+Shift+P`)
2. è¾“å…¥ "Turbo AI Rules: View Source Details"
3. é€‰æ‹©è¦æŸ¥çœ‹çš„è§„åˆ™æº

### 3. ä»ä»£ç è°ƒç”¨

```typescript
vscode.commands.executeCommand('turbo-ai-rules.viewSourceDetail', sourceId);
```

---

## ğŸ”§ æŠ€æœ¯æ ˆ

- **åç«¯**: TypeScript + VS Code Extension API
- **å‰ç«¯**: React 18 + TypeScript
- **æ„å»º**: Vite 7
- **æ ·å¼**: CSS (VS Code ä¸»é¢˜å˜é‡)

---

## ğŸ“ åç»­ä¼˜åŒ–

### å¯èƒ½çš„æ”¹è¿›ç‚¹

1. **è™šæ‹Ÿæ»šåŠ¨**: è§„åˆ™åˆ—è¡¨è¶…è¿‡ 100 æ¡æ—¶ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨æå‡æ€§èƒ½
2. **ç¼“å­˜ä¼˜åŒ–**: ç»Ÿè®¡æ•°æ®ç¼“å­˜ä»¥å‡å°‘è®¡ç®—
3. **å¯¼å‡ºåŠŸèƒ½**: æ”¯æŒå¯¼å‡ºè§„åˆ™æºçš„ç»Ÿè®¡æŠ¥å‘Š
4. **æ›´å¤šå›¾è¡¨**: æ·»åŠ æ›´ä¸°å¯Œçš„æ•°æ®å¯è§†åŒ–
5. **å†å²è®°å½•**: æ˜¾ç¤ºè§„åˆ™æºçš„åŒæ­¥å†å²

### å·²çŸ¥é™åˆ¶

1. ç»Ÿè®¡æ•°æ®åœ¨è§„åˆ™æ•°é‡ç‰¹åˆ«å¤§æ—¶ï¼ˆ>5000ï¼‰å¯èƒ½æœ‰æ€§èƒ½é—®é¢˜
2. æ ‡ç­¾äº‘æœ€å¤šæ˜¾ç¤º 6 ä¸ªæ ‡ç­¾
3. ç¼“å­˜å¤§å°è®¡ç®—æ˜¯åŒæ­¥çš„ï¼Œåœ¨å¤§ç¼“å­˜æ—¶å¯èƒ½é˜»å¡

---

## ğŸ”— ç›¸å…³æ–‡ä»¶

### æ ¸å¿ƒæ–‡ä»¶

- `src/providers/SourceDetailWebviewProvider.ts`
- `src/webview/source-detail/App.tsx`
- `src/commands/viewSourceDetail.ts`

### é…ç½®æ–‡ä»¶

- `package.json`
- `vite.config.ts`
- `package.nls.json`
- `package.nls.zh-cn.json`

### æ–‡æ¡£

- `.superdesign/design_docs/07-source-details-page.md` (è®¾è®¡æ–‡æ¡£)
- `.superdesign/design_iterations/07-source-details-page_1.html` (UI åŸå‹)

---

**å®æ–½è€…**: GitHub Copilot  
**å®¡æ ¸**: å¾…ç”¨æˆ·æµ‹è¯•  
**çŠ¶æ€**: âœ… å®æ–½å®Œæˆï¼Œå¾…æµ‹è¯•
